points(worldgraph.40k[temp],col="red")
sum(temp)
400/60
sel <- temp
sel <- getNodes(worldgraph.40k)[sel]
head(sel)
candidates
candidates <- sel
save(candidates, file="candidates.RData")
res <- doSimul(candidates[1:3], "outputs")
res <- doSimul(candidates[1:3], "outputs")
res
system.time(res <- doSimul(candidates[1:3], "outputs"))
candidates <- getNodes(worldgraph.40k)[isInArea(worldgraph.40k,locator(2))]
temp <- getNodes(worldgraph.40k)[isInArea(worldgraph.40k,locator(2))]
temp <- isInArea(worldgraph.40k,locator(2)) & worldgraph.40k@meta$habitat!="sea"
sum(temp)
sum(worldgraph.40k@meta$habitat!="sea")
worldgraph.40k@meta$habitat!="sea"
temp <- isInArea(worldgraph.40k,locator(2)) & worldgraph.40k@nodes.attr$habitat!="sea"
sum(temp)
candidates <- getNodes(worldgraph.40k,temp)
points(worldgraph.40k[temp],col="red")
save(candidates, file="candidates.RData")
res <- doSimul(candidates, "outputs")
candidates
length(candidates)
candidates <- getNodes(worldgraph.40k)[temp]
length(candidates)
save(candidates, file="candidates.RData")
res <- doSimul(candidates, "outputs")
res
range(res)
range(res,na.rm=TRUE)
save(res, file="/home/master/dev/geograph/pkg/misc/simulations/outputs/res.RData")
candidates
save(candidates, file="/home/master/dev/geograph/pkg/misc/simulations/outputs/candidates.RData")
names(res)[is.na(res)]
sum(is.na(res))
myNA <- names(res)[is.na(res)]
myNA %in% getNodes(hgdp)
length(getNodes(hgdp))
which.min(res)
hist(res, col="grey")

which.min(res)
load(paste("outputs/path",which.min(res),sep="/"))
load(paste("outputs/path",which.min(res),".RData",sep=""))
plot(myPath)
plot(worldgraph.40k,res=TRUE)
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath)
title("'worst' result")
x11()
load(paste("outputs/path",which.max(res),".RData",sep=""))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath)
title("'best' result")

which.max(res)
load(paste("outputs/path",which.max(res),".RData",sep=""))

load(paste("outputs/path",which.max(res),".RData",sep=""))

load(paste("outputs/path0",which.max(res),".RData",sep=""))

plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath)
title("'best' result")

x11()
load(paste("outputs/path",which.min(res),".RData",sep=""))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath)
title("'worst' result")

plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)

title("'best' result")

load(paste("outputs/path",which.min(res),".RData",sep=""))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
title("'worst' result")

## plot the best one
x11()
load(paste("outputs/path0",which.max(res),".RData",sep=""))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
title("'best' result")

plot(worldgraph.40k[candidates],reset=TRUE)
res
range(res)
range(res,na.rm=TRUE)
diff(range(res,na.rm=TRUE))
range(res/diff(range(res,na.rm=TRUE)),na.rm=T)
dispRes <- res
dispRes <- res - min(res,na.rm=TRUE)

range(dispRes,na.rm=T)
range(10*dispRes/max(dispRes,na.rm=T),na.rm=T)
dispRes <- 10*dispRes/max(dispRes,na.rm=T)
range(dispRes,na.rm=T)
dispRes <- res - min(res,na.rm=TRUE)
dispRes <- 1 + (99*dispRes/max(dispRes,na.rm=T))
range(dispRes,na.rm=T)

dispRes
dispRes <- res - min(res,na.rm=TRUE)
dispRes <- 1 + (99*dispRes/max(dispRes,na.rm=T))
range(dispRes,na.rm=T)

dispRes <- res - min(res,na.rm=TRUE)
dispRes <- 1 + (99*dispRes/max(dispRes,na.rm=T))
range(dispRes,na.rm=T)

x <- worldgraph.40k[candidates]
plot(x,reset=TRUE)

palette(heat.colors(110))
points(getCoords(x),col=dispRes,pch=20)

points(hgdp)
dispRes <- res - min(res,na.rm=TRUE)
dispRes <- 1 + (99*dispRes/max(dispRes,na.rm=T))
range(dispRes,na.rm=T)

x <- worldgraph.40k[candidates]
plot(x,reset=TRUE)

palette(heat.colors(110))
points(getCoords(x),col=dispRes,pch=20, )
points(hgdp,col="blue")
points(hgdp,node.col="blue")
points(hgdp,col.node="blue")
plot(1:20,pch=1:20)
plot(15:20,pch=15:20)
palette(heat.colors(105))
points(getCoords(x),col=dispRes,pch=15,cex=2)
points(hgdp,col.node="blue") # show the NA -> these are pop from hgdp

x <- worldgraph.40k[candidates]
plot(x,reset=TRUE)

palette(heat.colors(105))
points(getCoords(x),col=dispRes,pch=15,cex=2)
points(hgdp,col.node="blue") # show the NA -> these are pop from hgdp

x <- worldgraph.40k[candidates]
plot(x,reset=TRUE)

palette(heat.colors(105))
points(getCoords(x),col=dispRes,pch=15,cex=2)
points(hgdp,col.node="blue") # show the NA -> these are pop from hgdp
plot(x,reset=TRUE)
palette(heat.colors(105))
points(getCoords(x),col=dispRes,pch=15,cex=1)
points(hgdp,col.node="blue") # show the NA -> these are pop from hgdp

x <- worldgraph.40k[candidates]
plot(x,reset=TRUE)

palette(heat.colors(105))
points(getCoords(x),col=dispRes,pch=15,cex=2)
points(hgdp,col.node="blue") # show the NA -> these are pop from hgdp
plot(x,reset=TRUE)
palette(heat.colors(105))
points(getCoords(x),col=dispRes,pch=15,cex=1.5)
x <- worldgraph.40k[candidates]
plot(x,reset=TRUE)

palette(heat.colors(105))
points(getCoords(x),col=dispRes,pch=15,cex=2)
points(hgdp,col.node="blue") # show the NA -> these are pop from hgdp
plot(x,reset=TRUE)
palette(heat.colors(105))
points(getCoords(x),col=dispRes,pch=15,cex=1)
points(hgdp,col.node="blue") # show the NA -> these are pop from hgdp

load(paste("outputs/path",which.min(res),".RData",sep=""))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
title("'worst' result")

par(mar=c(0,0,2,0))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
title("'worst' result")

points(hgdp)
points(hgdp,col.node=TRUE)
points(hgdp,col.node="black")
head(names(myPath))
sub(":.*","",names(myPath)[1])
points(getNodes(x)[ori,],pch="x")
ori <- sub(":.*","",names(myPath)[1])
points(getNodes(x)[ori,],pch="x")

x
points(getCoords(x)[ori,],pch="x")

ori
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
points(hgdp,col.node="black")
ori <- sub(":.*","",names(myPath)[1])
points(getCoords(x)[ori,],pch="x", cex=2)
title("'worst' result")

ori
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
points(hgdp,col.node="black")
ori <- sub(":.*","",names(myPath)[1])
points(getCoords(x)[ori,1],getCoords(x)[ori,2],pch="x", cex=2)

plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
points(hgdp,col.node="black")
ori <- sub(":.*","",names(myPath)[1])
points(getCoords(x)[ori,1],getCoords(x)[ori,2],pch="x", cex=2,col="red")
title("'worst' result")

load(paste("outputs/path0",which.max(res),".RData",sep=""))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
points(hgdp,col.node="black")
ori <- sub(":.*","",names(myPath)[1])
points(getCoords(x)[ori,1],getCoords(x)[ori,2],pch="x", cex=2,col="red")
title("'best' result")


ori
load(paste("outputs/path",which.min(res),".RData",sep=""))
par(mar=c(0,0,2,0))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
points(hgdp,col.node="black")
ori <- sub(":.*","",names(myPath)[1])
points(getCoords(x)[ori,1],getCoords(x)[ori,2],pch="x", cex=2,col="red")
title("'worst' result")
ori
load(paste("outputs/path0",which.max(res),".RData",sep=""))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
points(hgdp,col.node="black")
ori <- sub(":.*","",names(myPath)[1])
points(getCoords(x)[ori,1],getCoords(x)[ori,2],pch="x", cex=2,col="red")
title("'best' result")

load(paste("outputs/path0",which.max(res),".RData",sep=""))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
points(hgdp,col.node="black")
ori <- sub(":.*","",names(myPath)[1])
points(getCoords(x)[ori,1],getCoords(x)[ori,2],pch="x", cex=2,col="red")
title("'best' result")

load(paste("outputs/path",which.min(res),".RData",sep=""))
par(mar=c(0,0,2,0))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
points(hgdp,col.node="black")
ori <- sub(":.*","",names(myPath)[1])
points(getCoords(x)[ori,1],getCoords(x)[ori,2],pch="x", cex=2,col="red")
title("'worst' result")

load(paste("outputs/path0",which.max(res),".RData",sep=""))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
points(hgdp,col.node="black")
ori <- sub(":.*","",names(myPath)[1])
points(getCoords(x)[ori,1],getCoords(x)[ori,2],pch="x", cex=2,col="red")
title("'best' result")

par(mar=c(0,0,2,0))
plot(worldgraph.40k,res=TRUE, col=0)
plot(myPath,seed=1)
points(hgdp,col.node="black")
ori <- sub(":.*","",names(myPath)[1])
points(getCoords(x)[ori,1],getCoords(x)[ori,2],pch="x", cex=2,col="red")
title("'best' result")

#
hist(res, col="grey")

hist(res, col="grey", main="R2 histogram")
hist(res, col="grey", main="Histogram of R2")
plot(1:100,col=1:100)
range(res,na.rm=T)
length(res)
which(is.na(res))
load("/home/master/dev/geograph/pkg/misc/simulations/outputs/path0036.RData")
head(myPath)
sapply(myPath, function(e) e$length)
sapply(myPath[-length(myPath)], function(e) e$length)
worldgraph.40k@meta$costs
which.max(res)
worldgraph.40k <- setFriction(worldgraph.40k, node.cost=1)
table(getCosts(worldgraph.40k))
table(getCosts(worldgraph.40k,res="vecto"))
temp <- dijkstraFrom(hgdp, "16074")
plot(worldgraph.40k,col=0)
plot(temp)
geo.dist <- sapply(temp[-length(temp)], function(e) e$length)
geo.dist
cor(geo.dist,hgdp@data$Genetic.Div)
cor(geo.dist,hgdp@data$Genetic.Div)^2
plot(geo.dist~hgdp@data$Genetic.Div)
plot(geo.dist,hgdp@data$Genetic.Div)
plot(log(geo.dist),hgdp@data$Genetic.Div)
plot(geo.dist,log(hgdp@data$Genetic.Div))
plot(geo.dist,hgdp@data$Genetic.Div)
range(res)
range(res,TRUE)
range(res,na.rm=T)
q()
n
